---
title: |
  EEE933 - Planejamento e Análise de Experimentos  
  Estudo de Caso 01: Comparação do IMC Médio de Alunos do PPGEE-UFMG
author:
  - "Bernardo Bacha\\thanks{PPGEE/UFMG — bernardobr@ufmg.br}"
  - "Autor 2 (placeholder)\\thanks{PPGEE/UFMG — autor2@email.com}"
  - "Autor 3 (placeholder)\\thanks{PPGEE/UFMG — autor3@email.com}"
  - "Autor 4 (placeholder)\\thanks{PPGEE/UFMG — autor4@email.com}"
date: "`r format(Sys.Date(), '%d de %B de %Y')`"
documentclass: article
output: pdf_document
fontsize: 10pt
geometry: margin=2cm
---








```{r setup,results='hide',warning=FALSE,echo=FALSE}
# Opções globais do knitr
knitr::opts_chunk$set(
  echo = TRUE,
  message = FALSE,
  warning = FALSE,
  fig.align = "center"
)

# Não instalar pacotes durante o Knit.
# Apenas checar e falhar com mensagem clara (instale no Console antes).
need <- c("ggplot2", "GGally", "broom")
miss <- need[!vapply(need, requireNamespace, logical(1), quietly = TRUE)]

if (length(miss)) {
  stop(
    sprintf(
      "Pacotes ausentes: %s\nInstale no Console antes de dar Knit, por ex.:\ninstall.packages(c(%s))",
      paste(miss, collapse = ", "),
      paste(sprintf('"%s"', miss), collapse = ", ")
    )
  )
}

# Carregamento (seguro pois já checamos acima)
library(ggplot2)
library(GGally)
library(broom)

# Se você instalou o TinyTeX, isso evita surpresas
if (requireNamespace("tinytex", quietly = TRUE)) {
  tinytex::is_tinytex() # só para forçar a detecção
}

```

# I. Descrição do Problema

Este estudo busca comparar o IMC médio dos alunos do PPGEE/UFMG entre os semestres **2016-2** e **2017-2**.  
Além da análise geral, também será feita a comparação separada por sexo (masculino e feminino).  

 

# II. Desenho Experimental

- **População de interesse:** alunos do PPGEE/UFMG.  
- **Variável resposta:** IMC = Peso / Altura².  
- **Fatores:** semestre (2016-2 vs 2017-2) e sexo (M/F).  
- **Hipóteses de teste (bicaudais):**  
  - H0: $\mu_{2016-2} = \mu_{2017-2}$  
  - H1: $\mu_{2016-2} \neq \mu_{2017-2}$

# III. Desenvolvimento
## Importação e Organização dos Dados

Primeiro, importamos os dados dos dois semestres (2016-2 e 2017-2), ajustamos o formato, filtramos apenas a pós-graduação e calculamos o IMC de cada estudante. Depois unimos tudo em um único dataframe.

```{r loaddata}
library(dplyr)

# Ler os dados
df_2017 <- read.csv("data/CS01_20172.csv", sep = ";")
df_2016 <- read.csv("data/imc_20162.csv")

# Ajustar e calcular IMC
df_2017 <- df_2017 %>%
  rename(Weight.kg = Weight.kg,
         Height.m  = height.m,
         Gender    = Sex) %>%
  mutate(semestre = "2017-2",
         IMC = Weight.kg / (Height.m^2))

df_2016 <- df_2016 %>%
  filter(Course == "PPGEE") %>%
  mutate(semestre = "2016-2",
         IMC = Weight.kg / (Height.m^2))

# Unir as duas bases
dados <- bind_rows(df_2016, df_2017)

# Resumo rápido
summary(dados$IMC)
table(dados$semestre, dados$Gender)
```


## Análise Exploratória

Agora vamos explorar os dados. O objetivo é entender como está a distribuição do IMC entre os alunos, comparando os dois semestres e separando por sexo. Para complementar, também apresentamos os resultados no grupo total.

### Boxplots

Os boxplots permitem observar a mediana, a dispersão e possíveis outliers do IMC em cada grupo.

```{r boxplots, fig.width=7, fig.height=4}
library(ggplot2)

# Adicionar categoria "Todos"
dados_global <- dados %>%
  mutate(Gender = as.character(Gender)) %>%
  bind_rows(dados %>% mutate(Gender = "Todos"))

# Boxplot
ggplot(dados_global, aes(x = semestre, y = IMC, fill = semestre)) +
  geom_boxplot() +
  facet_wrap(~ Gender) +
  labs(title = "Distribuição do IMC por semestre (global e por sexo)",
       x = "Semestre", y = "IMC")
```

### Histogramas

Já os histogramas mostram como os valores de IMC estão distribuídos dentro de cada grupo, ajudando a verificar se os dados seguem um padrão próximo da normalidade.

```{r histograms, fig.width=7, fig.height=4}
ggplot(dados_global, aes(x = IMC, fill = semestre)) +
  geom_histogram(alpha = 0.6, position = "identity", bins = 15) +
  facet_wrap(~ Gender) +
  labs(title = "Distribuição do IMC por semestre (global e por sexo)",
       x = "IMC", y = "Frequência")
```



# IV. Análise Estatística

## Validação das Premissas

### Normalidade

```{r normalidade_iv, fig.width=7, fig.height=4}
library(ggplot2)

# QQ-plots por semestre x sexo
ggplot(dados, aes(sample = IMC)) +
  stat_qq() +
  stat_qq_line() +
  facet_grid(semestre ~ Gender) +
  labs(title = "QQ-plots do IMC por semestre e sexo")

# Shapiro–Wilk por grupo (semestre x sexo)
grupos <- split(dados$IMC, list(dados$semestre, dados$Gender), drop = TRUE)
lapply(grupos, function(x) {
  if (length(x) >= 3 && length(x) <= 5000) shapiro.test(x) else NA
})
```

**Resultados (Shapiro–Wilk):**

* 2016-2 Feminino: p = 0.4674
* 2017-2 Feminino: p = 0.0366
* 2016-2 Masculino: p = 0.1275
* 2017-2 Masculino: p = 0.6206

**Nota:** o grupo feminino de 2017-2 tem **n = 4**. Com tamanhos tão pequenos, testes de normalidade ficam instáveis e sensíveis a um único valor. O resultado é registrado, mas será complementado com análise não-paramétrica na próxima subseção.


### Homogeneidade de Variâncias

```{r variancias_iv}
# Fligner–Killeen (robusto à não normalidade) entre semestres, por sexo
fligner.test(IMC ~ semestre, data = subset(dados, Gender == "M"))
fligner.test(IMC ~ semestre, data = subset(dados, Gender == "F"))
```

**Resultados (Fligner–Killeen):**

* Feminino: p = 0.7735
* Masculino: p = 0.3991

---

Boa! O problema é que alguns caracteres como **–** (traço longo), **±**, **µ** e afins não estão sendo renderizados no LaTeX.
A solução é escrever tudo no formato que o LaTeX entende: `\pm`, `\mu`, intervalos com colchetes `[...]` e traços simples.

Aqui está sua seção reescrita com código **antes** dos resultados e todo o texto em formato compatível com LaTeX:

---

## Teste de Hipóteses

Nesta etapa, comparamos as médias de IMC entre os semestres **2016-2** e **2017-2**, separadamente para homens e mulheres.
O teste utilizado foi o **t de Welch para duas amostras independentes**. O nível de significância adotado é **$\alpha = 0{,}05$**.

```{r t_welch}
# Homens
t.test(IMC ~ semestre, data = subset(dados, Gender == "M"),
       var.equal = FALSE, conf.level = 0.95)

# Mulheres
t.test(IMC ~ semestre, data = subset(dados, Gender == "F"),
       var.equal = FALSE, conf.level = 0.95)
```

**Resultados:**

* **Homens:** p = 0.5925, intervalo de confiança 95% = \[-1.79 ; 3.09]. Não houve evidência de diferença significativa entre os semestres. As médias foram 24.94 (2016-2) e 24.29 (2017-2).
* **Mulheres:** p = 0.0595, intervalo de confiança 95% = \[-0.14 ; 5.41]. A diferença não atingiu significância ao nível de 5%, mas ficou próxima do limiar. As médias foram 21.08 (2016-2) e 18.45 (2017-2).

---

## Tamanho do Efeito (Cohen’s d)

Além do p-valor, avaliamos a magnitude da diferença usando **Cohen’s d** (Hedges’ g com correção para amostras pequenas).

```{r cohens_d}
library(effsize)

# Homens
cohen.d(IMC ~ semestre, data = subset(dados, Gender == "M"),
        hedges.correction = TRUE)

# Mulheres
cohen.d(IMC ~ semestre, data = subset(dados, Gender == "F"),
        hedges.correction = TRUE)
```

**Resultados:**

* **Homens:** g = 0.16 (intervalo \[-0.45 ; 0.78]) → efeito desprezível.
* **Mulheres:** g = 1.11 (intervalo \[-0.28 ; 2.49]) → efeito grande, mas com intervalo de confiança muito amplo devido ao tamanho amostral reduzido.



# V. Discussão e Conclusões

Espaço reservado para:

* Interpretação dos resultados;
* Conclusões sobre diferenças de IMC entre semestres e sexos;
* Limitações do estudo.

 

# VI. Referências

Serão incluídas referências às notas de aula e bibliografia principal.
